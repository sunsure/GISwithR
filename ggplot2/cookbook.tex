%-----------------------------------------------%
13.12 Vector Fields
13.17 Creating a Map
13.18 Chloropleth maps
13.19 
13.20 Shapefiles
Wheatley
%-----------------------------------------------%
%Page 294
Creating a vector field
use \texttt{geom_segment}. Lets use the \texttt{isabel} data set.


library{gcookbook)
islabel

x and y are longtitude and latitude values respectively.
Z is the height in kilometres.

The vx,vy and vz are windspeed components in each of the directions (m/s).
Speed is the windspeed.

\begin{framed}
\begin{verbatim}


\end{verbatim}
\end{framed}

%Page 297
We can map speed to colour. We'll also ass a map of 
the USA and zoom in on the area of interest,as shown in the graph on the right.

%-----------%
%PAge 298
\begin{verbatim}
usa <- map_data("usa")
scale_colour_continuous(low="grey80",high="darkred")+
geom_path(aes(x=long,y=lat,group=group),data=usa)+
ggplot(islicesub, aes(x=x,y=y)) + geom_segment(aes(xend =x +vx/50,vend=y+vy/50,colour=speed),
\end{verbatim}
%-----------%
%PAge 299
The \textbf{\textit{isabel}} data set has three-dimensional, so we can make a faceted graph of the data.

\begin{verbatim}
#Page 299
ggplot(isub,aes(x=x, y=y)) + + geom_segment(aes(xend =x +vx/50,vend=y+vy/50,colour=speed),
scale_colour_continuous(low="grey80",high="darkred")+
facet_wrap(-z)
\end{verbatim}
%-----------------------------------------------%
%-----------------------------------------------%
%Page 309


The default projection is the Mercator projection

\begin{verbatim}
library(maps)
states_map <- map_data("state")
ggplot(states_map, aes(x=long,y=lat,group=group)) + geom_polygon(fill="white",colour="black")
\end{verbatim}

%-------------%
The \texttt{map-uscore-data()} function

\begin{itemize}
\item[long] Longtitude
\item[lat] Latitude
\item[group] This is a grouping variable for each polygon. A region or subregion might have multiple polygons.
\item[order] The order to connect each point in a group
\item[region] Roughly, the names of countries, although some other objects are lakes.
\end{itemize}
%-----------------------------------------------%

%----------------------------------------------%

% Page 311
It is possibel to get speciific regions from a particular map.

\begin{framed]
\begin{verbatim}
east_asia <- map_data("world",region=c("japan","China","North Korea","South Korea"))

#Map regions to fill colour

scale_fill_brewer("pallette_set2")
\end{verbatim}
\end{framed}
%----------------------------------------------%
%Page 312

If there is a separae map for each region, that map data will be at
higher resolution that in youw ere to extrac it from the ``world" map.

\begin{verbatim}
NZ1 <- map_data("world")

NZ2 <- map_data("nz")
ggplot(nz2 (aes(x=long,y=lat)) + geom_path().
\end{verbatim}
%----------------------------------------------%
%Section 13.18
%PAge 313
Creating a Chlorpleth Map

Creating a map where regions are colours according to some variable value.
\begin{verbatim}
library(maps)
states_map <- map_data("state")
crime_map <- merge(states_map,crimes,by.x="region",by.y="state")
head(crime_map)

library(plyr)

\end{verbatim}
%------------%
% Page 314

\begin{verbatim}
ggplot(crimes, aes(map_id=state,fill=Assault))+ 
...
expand_limits(x=states_map$long,y=states_map$lat) + 
coord_map("polyconic")

\end{verbatim}

%------------------------------------------------%

%Page317
Making a map with a clean background : removing background elements from a map.





%------------------------------------------------%
%PAge 318

\begin{verbatim}
ggplot(crimes
\end{verbatim}


%------------------------------------------------%
%PAge 319
%13.20 Creating a map from a shapefile

Creating a map from an ESRI shapefile.


%------------------------------------------------%
%------------------------------------------------%
%Wheatley
Packages
\begin{itemize}
\item sp vector data
\item raster grid data
\item rgdal input/output, coordinate systems
\item rgeos geometric calculations on vector data
\end{itemize}
%-------------------------------------------------%
Vector example: admin boundary
\begin{verbatim}
map <- getData('GADM',country='IRL', level=0)
projection(map)
# [1] "+proj=longlat +datum=WGS84"
\end{verbatim}
%------------------------------------------------%

Vector example: soil map of world
ESRI shapefile from fao.org
soils <- readOGR("~/DSMW/", "DSMW") #read
projection(soils) <- "+proj=longlat +datum=WGS84"
dim(soils@data)
#[1] 34112 12
soils@data[5000:5002,]
%------------------------------------------------%


Black Earth Soils
\begin{verbatim}
blackearth <- subset(soils, substr(DOMSOI,1,1) %in% c("C","K"))
>blackearth <- gUnaryUnion(blackearth)
\end{verbatim}




























